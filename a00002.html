<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Homeport Documentation: HomePort API Specification</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Homeport Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HomePort API Specification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec_arch">Overall architecture</a><ul><li class="level2"><a href="#sec_headers">Public header files</a></li>
<li class="level2"><a href="#sec_internal_arch">Internal architecture</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_use_cases">Use cases covered by the API</a><ul><li class="level2"><a href="#sec_configurator">Configurator</a></li>
<li class="level2"><a href="#sec_adapter_dev">Adapter Developer</a></li>
<li class="level2"><a href="#sec_application_dev">Application Developer</a></li>
<li class="level2"><a href="#sec_sub_task">Sub-tasks</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_data_mode">HomePort data model</a><ul><li class="level2"><a href="#sec_error_handling">Enumerations for error handling</a></li>
<li class="level2"><a href="#sec_attrs">Attribute default keys</a></li>
<li class="level2"><a href="#sec_methods">Method and Port enumeration</a></li>
<li class="level2"><a href="#sec_custom_data">Custom user data and free functions</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_main">Daemon API</a></li>
<li class="level1"><a href="#sec_shared_api">Shared API (Adapters and Applications) - Part I</a><ul><li class="level2"><a href="#sec_modules">Modules</a></li>
<li class="level2"><a href="#sec_logging">Logging</a></li>
<li class="level2"><a href="#sec_indirect_refs">Indirect references</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_adapter_api">Adapter API</a><ul><li class="level2"><a href="#sec_hpd_adapter_t">Adapter structure (hpd_adapter_t)</a></li>
<li class="level2"><a href="#sec_hpd_device_t">Device structure (hpd_device_t)</a></li>
<li class="level2"><a href="#sec_hpd_service_t">Service structure (hpd_service_t)</a></li>
<li class="level2"><a href="#sec_hpd_parameter_t">Parameter structure (hpd_parameter_t)</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_shared_api_cont">Shared API (Adapters and Applications) - Part II</a><ul><li class="level2"><a href="#sec_data_model_get">Data model getters</a></li>
<li class="level2"><a href="#sec_data_model_nav">Data model navigation</a></li>
</ul>
</li>
<li class="level1"><a href="#sec_comm">Communication</a><ul><li class="level2"><a href="#sec_value">Shared API - Value structure</a></li>
<li class="level2"><a href="#sec_adapter_comm">Adapter API - Communication</a></li>
<li class="level2"><a href="#sec_application_api">Application API - Communication</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sec_arch"></a>
Overall architecture</h1>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_1.svg"></object>
<div class="caption">
A HomePort Executable</div>
</div>
<p>In general, a HomePort installation consists of the HomePort library, one or more adapters and applications, and a main program that combines everything into one executable.</p><ul>
<li>Adapter: A module that provides a connection to one or more devices.</li>
<li>Application: A module that utilises this data, typically by providing an interface to a cloud.</li>
</ul>
<h2><a class="anchor" id="sec_headers"></a>
Public header files</h2>
<p>The header files provided by HomePort (excluding the common utilities) are structured in the following way:</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_2.svg"></object>
</div>
<p>Their purpose:</p><ul>
<li><a class="el" href="a00021.html">hpd_types.h</a>: Only type definitions, can be used in header files to obtain the types without the functions.</li>
<li><a class="el" href="a00056.html">hpd_shared_api.h</a>: Functionality shared between adapters and applications, used in libraries that may be used for both.</li>
<li><a class="el" href="a00052.html">hpd_adapter_api.h</a>: Adapter functionality, should only be included by adapters.</li>
<li><a class="el" href="a00054.html">hpd_application_api.h</a>: Application functionality, should only be included by applications.</li>
<li><a class="el" href="a00055.html">hpd_daemon_api.h</a>: Daemon functionality, should only be included in file defining <a class="el" href="a00034.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</li>
<li><a class="el" href="a00053.html">hpd_api.h</a>: Everything in one file for the lazy, sometimes used inside HomePort when it is not possible to separate between adapter and application functionality.</li>
</ul>
<h2><a class="anchor" id="sec_internal_arch"></a>
Internal architecture</h2>
<ul>
<li>Data Model:<ul>
<li><a class="el" href="a00005.html">model.h</a></li>
</ul>
</li>
<li>Communication Model:<ul>
<li><a class="el" href="a00024.html">comm.h</a></li>
</ul>
</li>
<li>Daemon Service:<ul>
<li><a class="el" href="a00057.html">daemon.c</a></li>
<li><a class="el" href="a00009.html">daemon.h</a></li>
<li><a class="el" href="a00058.html">daemon_api.c</a></li>
</ul>
</li>
<li>Discovery Service:<ul>
<li><a class="el" href="a00059.html">discovery.c</a></li>
<li><a class="el" href="a00011.html">discovery.h</a></li>
<li><a class="el" href="a00060.html">discovery_api.c</a></li>
<li><a class="el" href="a00061.html">discovery_id.c</a></li>
</ul>
</li>
<li>Event Dispatch Service:<ul>
<li><a class="el" href="a00062.html">event.c</a></li>
<li><a class="el" href="a00063.html">event.h</a></li>
<li><a class="el" href="a00064.html">event_api.c</a></li>
</ul>
</li>
<li>Log Dispatch Service:<ul>
<li><a class="el" href="a00065.html">log.c</a></li>
<li><a class="el" href="a00066.html">log.h</a></li>
<li><a class="el" href="a00067.html">log_api.c</a></li>
</ul>
</li>
<li>Request Dispatch Service:<ul>
<li><a class="el" href="a00068.html">request.c</a></li>
<li><a class="el" href="a00069.html">request.h</a></li>
<li><a class="el" href="a00070.html">request_api.c</a></li>
</ul>
</li>
<li>Value Service:<ul>
<li><a class="el" href="a00071.html">value.c</a></li>
<li><a class="el" href="a00072.html">value.h</a></li>
<li><a class="el" href="a00073.html">value_api.c</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="sec_use_cases"></a>
Use cases covered by the API</h1>
<p>Actors involved:</p><ul>
<li>Configurator: Collects a set of modules into an executable file with a main function.</li>
<li>Adapter developer.</li>
<li>Application developer.</li>
</ul>
<h2><a class="anchor" id="sec_configurator"></a>
Configurator</h2>
<p>Functionality provided by: <a class="el" href="a00055.html">hpd_daemon_api.h</a></p>
<p>Tasks:</p><ul>
<li>Start and stop HomePort [<a class="el" href="a00002.html#sec_main">Daemon API</a>].</li>
<li>Add modules to HomePort [<a class="el" href="a00002.html#sec_main">Daemon API</a>].</li>
</ul>
<p>In addition, the configurator needs the module definitions (hpd_module_def_t) as provided by the adapters and applications to add them to HomePort.</p>
<h2><a class="anchor" id="sec_adapter_dev"></a>
Adapter Developer</h2>
<p>Functionality provided by: <a class="el" href="a00052.html">hpd_adapter_api.h</a></p>
<p>Tasks:</p><ul>
<li>Define a HomePort module for the configurator [<a class="el" href="a00002.html#sec_modules">Modules</a>].</li>
<li>Manage the appropriate models in HomePort (adapters, devices, ...) [<a class="el" href="a00002.html#sec_adapter_api">Adapter API</a>].</li>
<li>Answer to a request for a value [<a class="el" href="a00002.html#sec_adapter_comm">Adapter API - Communication</a>].<ul>
<li>Read contents of PUT value [<a class="el" href="a00002.html#sec_value">Shared API - Value structure</a>].</li>
<li>Construct the value [<a class="el" href="a00002.html#sec_value">Shared API - Value structure</a>].</li>
</ul>
</li>
<li>Report that a service have changed value [<a class="el" href="a00002.html#sec_adapter_comm">Adapter API - Communication</a>].<ul>
<li>Construct the value [<a class="el" href="a00002.html#sec_value">Shared API - Value structure</a>].</li>
</ul>
</li>
</ul>
<p>In addition, the adapter developer may need to browse the models provided by the adapter, when communicating with the underlying network (as they can store data within these models) [<a class="el" href="a00002.html#sec_shared_api_cont">Shared API (Adapters and Applications) - Part II</a>].</p>
<h2><a class="anchor" id="sec_application_dev"></a>
Application Developer</h2>
<p>Functionality provided by: <a class="el" href="a00054.html">hpd_application_api.h</a></p>
<p>Tasks:</p><ul>
<li>Define a HomePort module for the configurator [<a class="el" href="a00002.html#sec_modules">Modules</a>].</li>
<li>Browsing available services in HomePort [<a class="el" href="a00002.html#sec_shared_api_cont">Shared API (Adapters and Applications) - Part II</a>].</li>
<li>Request a value [<a class="el" href="a00002.html#sec_application_api">Application API - Communication</a>].<ul>
<li>Construct the value for PUT request [<a class="el" href="a00002.html#sec_value">Shared API - Value structure</a>].</li>
<li>Read the response [<a class="el" href="a00002.html#sec_value">Shared API - Value structure</a>].</li>
</ul>
</li>
<li>Listen to events [<a class="el" href="a00002.html#sec_application_api">Application API - Communication</a>].</li>
</ul>
<h2><a class="anchor" id="sec_sub_task"></a>
Sub-tasks</h2>
<p>The following tasks may be a sub-component for those mentioned above:</p>
<ul>
<li>Functions for logging (error) messages [<a class="el" href="a00002.html#sec_logging">Logging</a>].</li>
<li>Functions for managing indirect references [<a class="el" href="a00002.html#sec_indirect_refs">Indirect references</a>].</li>
</ul>
<h1><a class="anchor" id="sec_data_mode"></a>
HomePort data model</h1>
<p>The model layer in HomePort remains consistent with previous version, and from the outside looks like this:</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_3.svg"></object>
<div class="caption">
HomePort Data Model</div>
</div>
<p>The internal class diagram for reference, most but not all types are available to the outside through references (direct access to members are generally not possible):</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_4.svg"></object>
<div class="caption">
Class diagram (Probably outdated)</div>
</div>
<h2><a class="anchor" id="sec_error_handling"></a>
Enumerations for error handling</h2>
<p>All functions in the API returns hpd_err_t, which is: </p><dl class="todo"><dt><b><a class="el" href="a00081.html#_todo000001">Todo:</a></b></dt><dd>Should really reconsider whether to have errors on free functions - really difficult to handle (there's a reason you're not suppose to throw in destructors!)</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0d">hpd_error</a> {</div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da4daeb92d8a8f80fa07ea5909d5efd940">HPD_E_SUCCESS</a> = 0,  <span class="comment">//&lt; The operation was successful.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da2f79bfa65b655d022e4c712ea08b05ef">HPD_E_UNKNOWN</a> = 1,  <span class="comment">//&lt; An unknown error</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da3e44c22b887a9371a8cf59644c2ea182">HPD_E_NULL</a>,         <span class="comment">//&lt; Null pointer error.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da74be3b084dd73433942c30fe6b4dc37a">HPD_E_ALLOC</a>,        <span class="comment">//&lt; Memory allocation error.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0dad314ace10a0f6198ba4007008d63af6c">HPD_E_STATE</a>,        <span class="comment">//&lt; An object is in an invalid state.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da4de1dbcac975eac38ddbde99d9b5f1fe">HPD_E_ARGUMENT</a>,     <span class="comment">//&lt; An argument is invalid.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da982739b885433cf1ae5f01874534cd5f">HPD_E_NOT_UNIQUE</a>,   <span class="comment">//&lt; An argument is not unique.</span></div>
<div class="line">    <a class="code" href="a00021.html#af2d90ea316126f626dd4bcd587cdfb0da3856d98f8e3b56ef9a5e8c8b5d7cdfb5">HPD_E_NOT_FOUND</a>,    <span class="comment">//&lt; The object could not be found.</span></div>
<div class="line">} <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a>;</div>
</div><!-- fragment --><p> For the request-response relationships HomePort continues to use HTTP status codes to describe errors, as many modules relies on HTTP connections. From the HTTP protocol, these are:</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#define HPD_HTTP_STATUS_CODE_MAP(XX) \</span></div>
<div class="line"><span class="preprocessor">    XX(100, Continue) \</span></div>
<div class="line"><span class="preprocessor">    XX(101, Switching Protocols) \</span></div>
<div class="line"><span class="preprocessor">    XX(200, OK) \</span></div>
<div class="line"><span class="preprocessor">    XX(201, Created) \</span></div>
<div class="line"><span class="preprocessor">    XX(202, Accepted) \</span></div>
<div class="line"><span class="preprocessor">    XX(203, Non-Authoritative Information) \</span></div>
<div class="line"><span class="preprocessor">    XX(204, No Content) \</span></div>
<div class="line"><span class="preprocessor">    XX(205, Reset Content) \</span></div>
<div class="line"><span class="preprocessor">    XX(206, Partial Content) \</span></div>
<div class="line"><span class="preprocessor">    XX(300, Multiple Choices) \</span></div>
<div class="line"><span class="preprocessor">    XX(301, Moved Permanently) \</span></div>
<div class="line"><span class="preprocessor">    XX(302, Found) \</span></div>
<div class="line"><span class="preprocessor">    XX(303, See Other) \</span></div>
<div class="line"><span class="preprocessor">    XX(304, Not Modified) \</span></div>
<div class="line"><span class="preprocessor">    XX(305, Use Proxy) \</span></div>
<div class="line"><span class="preprocessor">    XX(306, (Unused)) \</span></div>
<div class="line"><span class="preprocessor">    XX(307, Temporary Redirect) \</span></div>
<div class="line"><span class="preprocessor">    XX(400, Bad Request) \</span></div>
<div class="line"><span class="preprocessor">    XX(401, Unauthorized) \</span></div>
<div class="line"><span class="preprocessor">    XX(402, Payment Required) \</span></div>
<div class="line"><span class="preprocessor">    XX(403, Forbidden) \</span></div>
<div class="line"><span class="preprocessor">    XX(404, Not Found) \</span></div>
<div class="line"><span class="preprocessor">    XX(405, Method Not Allowed) \</span></div>
<div class="line"><span class="preprocessor">    XX(406, Not Acceptable) \</span></div>
<div class="line"><span class="preprocessor">    XX(407, Proxy Authentication Required) \</span></div>
<div class="line"><span class="preprocessor">    XX(408, Request Timeout) \</span></div>
<div class="line"><span class="preprocessor">    XX(409, Conflict) \</span></div>
<div class="line"><span class="preprocessor">    XX(410, Gone) \</span></div>
<div class="line"><span class="preprocessor">    XX(411, Length Required) \</span></div>
<div class="line"><span class="preprocessor">    XX(412, Precondition Failed) \</span></div>
<div class="line"><span class="preprocessor">    XX(413, Request Entity Too Large) \</span></div>
<div class="line"><span class="preprocessor">    XX(414, Request-URI Too Long) \</span></div>
<div class="line"><span class="preprocessor">    XX(415, Unsupported Media Type) \</span></div>
<div class="line"><span class="preprocessor">    XX(416, Requested Range Not Satisfiable) \</span></div>
<div class="line"><span class="preprocessor">    XX(417, Expectation Failed) \</span></div>
<div class="line"><span class="preprocessor">    XX(500, Internal Server Error) \</span></div>
<div class="line"><span class="preprocessor">    XX(501, Not Implemented) \</span></div>
<div class="line"><span class="preprocessor">    XX(502, Bad Gateway) \</span></div>
<div class="line"><span class="preprocessor">    XX(503, Service Unavailable) \</span></div>
<div class="line"><span class="preprocessor">    XX(504, Gateway Timeout) \</span></div>
<div class="line"><span class="preprocessor">    XX(505, HTTP Version Not Supported)</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="a00021.html#ae4a225ffa1d7c54da791fd9109d8b026">hpd_status</a> {</div>
<div class="line"><span class="preprocessor">#define XX(num, str) HPD_S_##num = num,</span></div>
<div class="line">    <a class="code" href="a00021.html#af6a35195aed41ee7ef7387765e48eae9">HPD_HTTP_STATUS_CODE_MAP</a>(<a class="code" href="a00017.html#ad3a6c0d2c0459b52d11d4abe39beec21">XX</a>)</div>
<div class="line"><span class="preprocessor">#undef XX</span></div>
<div class="line">} <a class="code" href="a00021.html#af6829d4094acafb9d01a245f98ebd995">hpd_status_t</a>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_attrs"></a>
Attribute default keys</h2>
<p>The entities in the data model are described using attributes. These are flexible key-value pairs, where the keys can be chosen freely. However, we do define the following default keys for consistencies between modules: </p><dl class="todo"><dt><b><a class="el" href="a00081.html#_todo000002">Todo:</a></b></dt><dd>As with default keys, we could add default values as well; Type = Temperature, Unit = C, etc. Seluxit and Zigbee can be used for inspiration (Rene’s work).</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#afd063bef22bfdb7b0ad41f08b4861716">HPD_ATTR_NETWORK</a>  = <span class="stringliteral">&quot;network&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a540d22cb78f555a5f25b21ab607683be">HPD_ATTR_DESC</a>     = <span class="stringliteral">&quot;description&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#ac948ba8992ec0a52b645f60d9b230097">HPD_ATTR_VENDOR</a>   = <span class="stringliteral">&quot;vendor&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a2afb0aa6d46cf4601b73d8d08d6aea71">HPD_ATTR_PRODUCT</a>  = <span class="stringliteral">&quot;product&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a78daad1c7f876af6943bb6fe340f5c50">HPD_ATTR_VERSION</a>  = <span class="stringliteral">&quot;version&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#ab67af0a442b049e45daeb2d2af7271dd">HPD_ATTR_LOCATION</a> = <span class="stringliteral">&quot;location&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#aff4150f68e4fc6506adc361a2620b8fc">HPD_ATTR_TYPE</a>     = <span class="stringliteral">&quot;type&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a652841436839645120dbff5d24a8eecf">HPD_ATTR_UNIT</a>     = <span class="stringliteral">&quot;unit&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#ae2401d47fd4f87fff5953edab5075157">HPD_ATTR_MAX</a>      = <span class="stringliteral">&quot;max&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#addb02685571b0901d347a0b35146a0c2">HPD_ATTR_MIN</a>      = <span class="stringliteral">&quot;min&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#ab6c6b8c13398bb014aec754799c6bb57">HPD_ATTR_STEP</a>     = <span class="stringliteral">&quot;step&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a646f1a37ce12164a5460cdcc92e9ed42">HPD_ATTR_SCALE</a>    = <span class="stringliteral">&quot;scale&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="a00021.html#a113290a892b3db5ebfa7f118b5728096">HPD_ATTR_VALUES</a>   = <span class="stringliteral">&quot;values&quot;</span>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_methods"></a>
Method and Port enumeration</h2>
<p>Services have a set of actions, currently for get and put only, but these are define in a enumeration, thus can easily be expanded later:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="a00021.html#ae5973cb13ba680422f6381e98b783dd1">hpd_method</a> {</div>
<div class="line">    <a class="code" href="a00021.html#ae5973cb13ba680422f6381e98b783dd1a2c38a7f6fd4aea028bccace7aa2e5df4">HPD_M_NONE</a> = -1, <span class="comment">//&lt; Method that does not exist, must be first below valid methods</span></div>
<div class="line">    <a class="code" href="a00021.html#ae5973cb13ba680422f6381e98b783dd1a4aa1b1492e9715dc6214b6ebf1fa21f0">HPD_M_GET</a> = 0,   <span class="comment">//&lt; HTTP GET like method</span></div>
<div class="line">    <a class="code" href="a00021.html#ae5973cb13ba680422f6381e98b783dd1abb3582c2747d9760897062694fa369a5">HPD_M_PUT</a>,       <span class="comment">//&lt; HTTP PUT like method</span></div>
<div class="line">    <a class="code" href="a00021.html#ae5973cb13ba680422f6381e98b783dd1aa248a39ea7ed1f64d1b3fc38009c1924">HPD_M_COUNT</a>      <span class="comment">//&lt; Last</span></div>
<div class="line">} <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_custom_data"></a>
Custom user data and free functions</h2>
<p>HomePort's data model allow module developers to store custom pointers to user data of their own choice. HomePort will not touch this data. To allow memory management of custom data pointers, HomePort generally take a on_free callback function with the data pointer. This function will be called when HomePort is free'ing the object and can be used by the module developer to ensure that the custom data is free'd as well. The function pointer can be NULL, if it is not necessary to free the data.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a>) (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>); <span class="comment">//&lt; Free function, used to free user supplied data.</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="sec_main"></a>
Daemon API</h1>
<div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00055.html#a3d879947af1cc338c9bb9cf68fcce672">hpd_alloc</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> **<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00055.html#aa833627ad45d82173c0caf687cd30126">hpd_free</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00055.html#a6539e14b83acd08c031e8c8813d2b13e">hpd_module</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>, <a class="code" href="a00021.html#a00100">hpd_module_def_t</a> *module_def);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00055.html#a4a5e670df4a5790a7955aaef5483c08a">hpd_start</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00055.html#ad279f4f771e132927c09bd599fbe2b1b">hpd_stop</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>);</div>
</div><!-- fragment --><p> First, the main program allocates memory for HomePort (hpd_t) with <a class="el" href="a00055.html#a3d879947af1cc338c9bb9cf68fcce672" title="[hpd_t functions] ">hpd_alloc()</a>. Then it tells HomePort of all modules that it wishes to include with <a class="el" href="a00055.html#a6539e14b83acd08c031e8c8813d2b13e">hpd_module()</a>. We shall use the term module for both adapters and applications. All modules are assigned a unique id by the main program, which allows running multiple instances of the same module. module_def is a public structure, of which each module should provide an instance (explained below).</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_5.svg"></object>
<div class="caption">
Main program</div>
</div>
<p>The main program will then start HomePort with <a class="el" href="a00055.html#a4a5e670df4a5790a7955aaef5483c08a">hpd_start()</a>. Note that this function does not return, but will keep running until <a class="el" href="a00055.html#ad279f4f771e132927c09bd599fbe2b1b">hpd_stop()</a> is called. <a class="el" href="a00055.html#ad279f4f771e132927c09bd599fbe2b1b">hpd_stop()</a> will be called automatically on sigint and sigterm. Finally, the main program will deallocate the memory with <a class="el" href="a00055.html#aa833627ad45d82173c0caf687cd30126">hpd_free()</a>.</p>
<p>Any pointer to hpd_t is valid between calls to <a class="el" href="a00055.html#a3d879947af1cc338c9bb9cf68fcce672" title="[hpd_t functions] ">hpd_alloc()</a> and <a class="el" href="a00055.html#aa833627ad45d82173c0caf687cd30126">hpd_free()</a>, and thus can generally be stored by modules in their entire lifetime.</p>
<h1><a class="anchor" id="sec_shared_api"></a>
Shared API (Adapters and Applications) - Part I</h1>
<h2><a class="anchor" id="sec_modules"></a>
Modules</h2>
<p>A module will provide an instance of the module_def structure along with implementations of the five included functions. module_def is a structure where the members are publicly available.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00021.html#a00100">hpd_module_def</a> {</div>
<div class="line">    <a class="code" href="a00021.html#aacdb1ff1a0bb08ccff0090af6e90b67d">hpd_create_f</a> <a class="code" href="a00021.html#ac5e987b98f2cb8f414920c7e7d254e31">on_create</a>;</div>
<div class="line">    <a class="code" href="a00021.html#a206271176a15bb48166e0e5059d2e21f">hpd_destroy_f</a> <a class="code" href="a00021.html#a6f33b1825d892dadab69abc2d95d9c54">on_destroy</a>;</div>
<div class="line">    <a class="code" href="a00021.html#a3235cf0b8166f4a875daac55f5892766">hpd_start_f</a> <a class="code" href="a00021.html#ab49d3704883a41920340d4bc8f9dff13">on_start</a>;</div>
<div class="line">    <a class="code" href="a00021.html#a609e923b2efa9d44a8450c815b2bbc74">hpd_stop_f</a> <a class="code" href="a00021.html#afc46e3a02a31aa7c392901b395d2e882">on_stop</a>;</div>
<div class="line">    <a class="code" href="a00021.html#ad154f5de88f915a61a45ab0a08cb1d03">hpd_parse_opt_f</a> <a class="code" href="a00021.html#a6df5927a6ae5bea30b4f1f44898d3cb8">on_parse_opt</a>;</div>
<div class="line">} <a class="code" href="a00021.html#ad691b2bbbacb07a7d780cd7edc6bdf52">hpd_module_def_t</a>;</div>
</div><!-- fragment --><p> The five functions: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#aacdb1ff1a0bb08ccff0090af6e90b67d">hpd_create_f</a>)    (<span class="keywordtype">void</span> **<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <a class="code" href="a00020.html">hpd_module_t</a> *context);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a206271176a15bb48166e0e5059d2e21f">hpd_destroy_f</a>)   (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a3235cf0b8166f4a875daac55f5892766">hpd_start_f</a>)     (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a609e923b2efa9d44a8450c815b2bbc74">hpd_stop_f</a>)      (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><span class="comment">// TODO Document that this should return HPD_E_ARGUMENT if name is now known....</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#ad154f5de88f915a61a45ab0a08cb1d03">hpd_parse_opt_f</a>) (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg);</div>
</div><!-- fragment --><p> In here, on_create and on_destroy are used to allocate/deallocate globally available memory in data, which can be used freely. on_start and on_stop are used to initialise/stop the underlying connection and add watchers to the event loop – whatever is required for the module to be considered running. To handle program argument given to the executable, a module can also define on_parse_opt, which may be called between on_create and on_start due to arguments given to the executable.</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_6.svg"></object>
<div class="caption">
Module functions and object lifetime</div>
</div>
<p>The following three functions are shared between adapters and applications: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ae215a28ac4e61dfa35bee54fa68f59dc">hpd_module_add_option</a>(<a class="code" href="a00020.html">hpd_module_t</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> flags, <span class="keyword">const</span> <span class="keywordtype">char</span> *doc);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad2f7effac0a1e5955e159ea5aca1ea78">hpd_module_get_id</a>(<a class="code" href="a00020.html">hpd_module_t</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#abb80916ac5990db56afd0fc309949f4c">hpd_get_loop</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00021.html#a8b9d6b16dbb9ccaf08497a11cc0b1d29">hpd_ev_loop_t</a> **<a class="code" href="a00039.html#a855923b555731173d3509ecb645de0e0">loop</a>);</div>
</div><!-- fragment --><p> For arguments to work, the module will have to add any options using <a class="el" href="a00056.html#ae215a28ac4e61dfa35bee54fa68f59dc" title="[hpd_t functions] ">hpd_module_add_option()</a> during on_create. Options will be named &ndash;id-name, where id is the module identifier, as given by the main program. The module can call <a class="el" href="a00056.html#ad2f7effac0a1e5955e159ea5aca1ea78">hpd_module_get_id()</a> to obtain this id. During on_start and afterwards, the event loop will be accessible through <a class="el" href="a00056.html#abb80916ac5990db56afd0fc309949f4c">hpd_get_loop()</a>. On here, the module can put io-watchers, timer-watchers, and more to trigger on events.</p>
<p>A module can rely on the pointer to its hpd_module_t (as given in <a class="el" href="a00030.html#af4753a1c6fc6c6d064198a1f56fb4820">on_create()</a>) will be valid for its entire lifetime, that is between calls to on_create and on_destroy. The pointer to its id (as obtained with <a class="el" href="a00056.html#ad2f7effac0a1e5955e159ea5aca1ea78">hpd_module_get_id()</a>) is valid in the same interval. The pointer to the event loop (as obtained with <a class="el" href="a00056.html#abb80916ac5990db56afd0fc309949f4c">hpd_get_loop()</a>) is valid between calls to on_start and on_stop.</p>
<h2><a class="anchor" id="sec_logging"></a>
Logging</h2>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2">hpd_log_level</a> {</div>
<div class="line">    <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2ab809c83c0fac1decee6f5fa93faaa32c">HPD_L_ERROR</a>,</div>
<div class="line">    <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2a27b5aeeb31289b21e4c73f79c983a33a">HPD_L_WARN</a>,</div>
<div class="line">    <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2a46e3ea561c3d8cae140943f98754cfbf">HPD_L_INFO</a>,</div>
<div class="line">    <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2aeb426717209696ae37bb52aa0487326f">HPD_L_DEBUG</a>,</div>
<div class="line">    <a class="code" href="a00021.html#aa89d79ab2946861491c24c5a0868f6c2abe65ad03e9a9c73a69619f994f71e345">HPD_L_VERBOSE</a>,</div>
<div class="line">} <a class="code" href="a00021.html#ae3a610c1a6d76924196036930d9ce8dc">hpd_log_level_t</a>;</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aeae04e52f7ec61b5f07fce88a3380a5f">hpd_logf</a>(<a class="code" href="a00020.html">hpd_module_t</a> *context, <a class="code" href="a00021.html#ae3a610c1a6d76924196036930d9ce8dc">hpd_log_level_t</a> level, <span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a8ef10c6537eea5fd723aa619bbc2bf4c">hpd_vlogf</a>(<a class="code" href="a00020.html">hpd_module_t</a> *context, <a class="code" href="a00021.html#ae3a610c1a6d76924196036930d9ce8dc">hpd_log_level_t</a> level, <span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, va_list vp);</div>
<div class="line"><span class="preprocessor">#define HPD_LOG_ERROR(CONTEXT, FMT, ...) hpd_logf((CONTEXT), HPD_L_ERROR, __FILE__, __LINE__, (FMT), ##__VA_ARGS__)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_WARN(CONTEXT, FMT, ...) hpd_logf((CONTEXT), HPD_L_WARN , __FILE__, __LINE__, (FMT), ##__VA_ARGS__)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_INFO(CONTEXT, FMT, ...) hpd_logf((CONTEXT), HPD_L_INFO , __FILE__, __LINE__, (FMT), ##__VA_ARGS__)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_DEBUG(CONTEXT, FMT, ...) hpd_logf((CONTEXT), HPD_L_DEBUG, __FILE__, __LINE__, (FMT), ##__VA_ARGS__)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_VERBOSE(CONTEXT, FMT, ...) hpd_logf((CONTEXT), HPD_L_VERBOSE, __FILE__, __LINE__, (FMT), ##__VA_ARGS__)</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_RETURN(CONTEXT, E, FMT, ...) do { HPD_LOG_DEBUG((CONTEXT), (FMT), ##__VA_ARGS__); return (E); } while(0)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_RETURN_E_NULL(CONTEXT)  HPD_LOG_RETURN((CONTEXT), HPD_E_NULL,  &quot;Unexpected null pointer.&quot;)</span></div>
<div class="line"><span class="preprocessor">#define HPD_LOG_RETURN_E_ALLOC(CONTEXT) HPD_LOG_RETURN((CONTEXT), HPD_E_ALLOC, &quot;Unable to allocate memory.&quot;)</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_indirect_refs"></a>
Indirect references</h2>
<p>Through the following sections we shall utilise indirect references to objects in the data mode (adapters, devices, services, parameters). These prevent module developers from keeping pointers to objects that eventually will be free'd, thus making these pointers invalid. To allocate and free these references:</p>
<div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aaf24eefdbdf2debbf530eb19db96bd86">hpd_adapter_id_alloc</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **<span class="keywordtype">id</span>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *aid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a6d2b00a1eb132508e48ea8fba1f7e4ce">hpd_adapter_id_copy</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **dst, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *src);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a6dfca5e2723ca3a11d12fe545e69923e">hpd_adapter_id_free</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a990c7b89fc6040ae81d835df174980d4">hpd_device_id_alloc</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **<span class="keywordtype">id</span>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *aid, <span class="keyword">const</span> <span class="keywordtype">char</span> *did);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a3d2f9767d135be08697ceeff15ef46bf">hpd_device_id_copy</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **dst, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *src);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a9a00d602f27e6ec01adf931e9daaeb42">hpd_device_id_free</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#adcfc7ced2dccafaac60ca13f700061d5">hpd_service_id_alloc</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **<span class="keywordtype">id</span>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *aid, <span class="keyword">const</span> <span class="keywordtype">char</span> *did, <span class="keyword">const</span> <span class="keywordtype">char</span> *sid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a06b25de4929ff540e0f7553404730e56">hpd_service_id_copy</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **dst, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *src);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a19ce779c8a8a82fcb624cd7631eaee20">hpd_service_id_free</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ac1e2289044cde6f0f992588a434fa891">hpd_parameter_id_alloc</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **<span class="keywordtype">id</span>, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *aid, <span class="keyword">const</span> <span class="keywordtype">char</span> *did, <span class="keyword">const</span> <span class="keywordtype">char</span> *sid, <span class="keyword">const</span> <span class="keywordtype">char</span> *pid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2e143536ee2b6fe282b15b52e22b98ea">hpd_parameter_id_copy</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **dst, <a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *src);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a672ca4a557b724d795853002ea453429">hpd_parameter_id_free</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *<span class="keywordtype">id</span>);</div>
</div><!-- fragment --><p> If a module developers explicitly call *_id_alloc(), they are also responsible for calling *_id_free().</p>
<h1><a class="anchor" id="sec_adapter_api"></a>
Adapter API</h1>
<p>The functions in the Adapter API are only available for adapters.</p>
<h2><a class="anchor" id="sec_hpd_adapter_t"></a>
Adapter structure (hpd_adapter_t)</h2>
<p>To maintain adapter structures in the data model: </p><dl class="todo"><dt><b><a class="el" href="a00081.html#_todo000003">Todo:</a></b></dt><dd>Maybe change name of the structure from “adapter” to “network” to highlight the differences between modules and adapters. A module can make multiple networks of devices.</dd></dl>
<div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#aec51fa5c17a707a90a1634358ae1a9b4">hpd_adapter_alloc</a>(<a class="code" href="a00010.html">hpd_adapter_t</a> **adapter, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a0a2b0d9eef603396a0171d5b0c67bbbf">hpd_adapter_free</a>(<a class="code" href="a00010.html">hpd_adapter_t</a> *adapter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a247f5a01789cd6bd85a2f1238d36c29c">hpd_adapter_attach</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00010.html">hpd_adapter_t</a> *adapter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ace6bdcd24107e5a84d35a2dc90d3c58e">hpd_adapter_detach</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00010.html">hpd_adapter_t</a> **adapter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ae4435821a3fd887ed393c05dacd2a79d">hpd_adapter_set_data</a>(<a class="code" href="a00010.html">hpd_adapter_t</a> *adapter, <span class="keywordtype">void</span> *data, <a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a> <a class="code" href="a00025.html#a65f3fe01ba50f1473cad1a4418cfdf09">on_free</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a0d5ca643908e5c921d763ad9f5c9ba8e">hpd_adapter_set_attr</a>(<a class="code" href="a00010.html">hpd_adapter_t</a> *adapter, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a0dc61e22d6abc5a621e53cd3aab2f9ca">hpd_adapter_set_attrs</a>(<a class="code" href="a00010.html">hpd_adapter_t</a> *adapter, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a5d553f4b467dd4f742f17ac22b5a1240">hpd_adapter_get_data</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, <span class="keywordtype">void</span> **data);</div>
</div><!-- fragment --><p> alloc/free are used to manage memory. attach/detach are used to hand the object to HomePort. If an object is attached, it will be visibly through the navigation functions (shown later) and HomePort will ensure that the memory is managed. For example this means that if an adapter is freed, all devices, services, etc. below it will automatically be freed also. Note that the reverse applies too; if an object is detached, HomePort do not know about it and it is up to the module to manage the memory. set_data/get_data functions can be used, by the adapter, to store custom data within HomePort. If on_free is set, HomePort will call this function to free this custom data, when the object is freed.</p>
<p>As to when to use a direct pointer to the adapter and when to use an indirect reference, see the following diagram. <a class="el" href="a00052.html#aec51fa5c17a707a90a1634358ae1a9b4" title="[hpd_adapter_t functions] ">hpd_adapter_alloc()</a> allocates the instance of hpd_adapter_t, which is referred to using a pointer - the module developer is in control of the memory. The object is changed (set functions), and finally <a class="el" href="a00052.html#a247f5a01789cd6bd85a2f1238d36c29c">hpd_adapter_attach()</a> is called. After this call the pointer <em>will</em> be invalid and we can only refer to the object using instances of hpd_adapter_id_t (indirect references) - HomePort manages the memory.</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_7.svg"></object>
<div class="caption">
Lifetime of adapter structures (Outside view, not exact implementation)</div>
</div>
<p>After a call to <a class="el" href="a00052.html#ace6bdcd24107e5a84d35a2dc90d3c58e">hpd_adapter_detach()</a>, the indirect reference will still be allocated, but will now result in HPD_E_NOT_FOUND, if we try to use it. <a class="el" href="a00052.html#ace6bdcd24107e5a84d35a2dc90d3c58e">hpd_adapter_detach()</a> also returns a pointer to hpd_adapter_t &ndash; it is now the responsibility of the module to free the object.</p>
<dl class="section user"><dt>Implementation details:</dt><dd><a class="el" href="a00052.html#a247f5a01789cd6bd85a2f1238d36c29c">hpd_adapter_attach()</a> will make a copy of hpd_adapter_t, thus effectively invalidating the pointer. <a class="el" href="a00052.html#ace6bdcd24107e5a84d35a2dc90d3c58e">hpd_adapter_detach()</a> will return a pointer to this copy, which was stored in the internal data model.</dd></dl>
<h2><a class="anchor" id="sec_hpd_device_t"></a>
Device structure (hpd_device_t)</h2>
<p>Devices are managed in a similar manner: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a10a4b84cc7128e1900008dc1de4653a2">hpd_device_alloc</a>(<a class="code" href="a00013.html">hpd_device_t</a> **device, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a7b20f2cfe2e46cdbfe4112b95922446b">hpd_device_free</a>(<a class="code" href="a00013.html">hpd_device_t</a> *device);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a7fb3db782a5ba49583a5abf615f260bd">hpd_device_attach</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00013.html">hpd_device_t</a> *device);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a228c00929674efd7d29edec9043b2da6">hpd_device_detach</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00013.html">hpd_device_t</a> **device);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a082d6cbdcf9bc2051d3372e9275b7c9f">hpd_device_set_data</a>(<a class="code" href="a00013.html">hpd_device_t</a> *device, <span class="keywordtype">void</span> *data, <a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a> <a class="code" href="a00025.html#a65f3fe01ba50f1473cad1a4418cfdf09">on_free</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#aa52044afe11425f0febeba4f6094e48f">hpd_device_set_attr</a>(<a class="code" href="a00013.html">hpd_device_t</a> *device, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a79a100958212cd7d8be053ceeb15885c">hpd_device_set_attrs</a>(<a class="code" href="a00013.html">hpd_device_t</a> *device, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a239e02b06de609abc07a7af56f43209b">hpd_device_get_data</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>, <span class="keywordtype">void</span> **data);</div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_hpd_service_t"></a>
Service structure (hpd_service_t)</h2>
<p>Services furthermore allow setting an action, which is a method and a function pointer. Currently only get and put is support, but it could theoretically be expanded to others: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ae265c33796304a96d8a0e670e61e7a3a">hpd_service_alloc</a>(<a class="code" href="a00026.html">hpd_service_t</a> **service, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#acebc47c8796cb46b14899df696fae147">hpd_service_free</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#af441be40a9cec089a7bd655e5b7bc61c">hpd_service_attach</a>(<a class="code" href="a00013.html">hpd_device_t</a> *device, <a class="code" href="a00026.html">hpd_service_t</a> *service);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a2f5dcf91dddd8b49a61f53627740452b">hpd_service_detach</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00026.html">hpd_service_t</a> **service);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a3974326e212a829eef3dc2a4f554ccf0">hpd_service_set_data</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, <span class="keywordtype">void</span> *data, <a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a> <a class="code" href="a00025.html#a65f3fe01ba50f1473cad1a4418cfdf09">on_free</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ad7f06997cb2f69f3decb671a16d2bdb6">hpd_service_set_attr</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a436b38305c5c560b7c2d78285ac7e27c">hpd_service_set_attrs</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a66883e77bc53793b588c5768621c477e">hpd_service_set_action</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, <span class="keyword">const</span> <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> method, <a class="code" href="a00021.html#a8811f9b04126b4b27f9b284d139a41d0">hpd_action_f</a> action);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a8a4f9edb085f44b1eb5d9b31447f06c9">hpd_service_set_actions</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ad0fd5e015b802be56562d809b90aec61">hpd_service_get_data</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <span class="keywordtype">void</span> **data);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a8811f9b04126b4b27f9b284d139a41d0">hpd_action_f</a>) (<a class="code" href="a00024.html#a00103">hpd_request_t</a> *req); <span class="comment">//&lt; Action function for handling requests on services.</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_hpd_parameter_t"></a>
Parameter structure (hpd_parameter_t)</h2>
<p>Finally, functions to manage parameters: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a510d8b9b58d0cf4d661e7e433004ca10">hpd_parameter_alloc</a>(<a class="code" href="a00023.html">hpd_parameter_t</a> **parameter, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ad8c6360b9faf931207a84a045e44b858">hpd_parameter_free</a>(<a class="code" href="a00023.html">hpd_parameter_t</a> *parameter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#add11419bd4fd209882bbe83c8ce8442a">hpd_parameter_attach</a>(<a class="code" href="a00026.html">hpd_service_t</a> *service, <a class="code" href="a00023.html">hpd_parameter_t</a> *parameter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a21949d52d159e419269cea721026552e">hpd_parameter_detach</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00023.html">hpd_parameter_t</a> **parameter);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#ac80954392c6e6b03259a057603784b9b">hpd_parameter_set_attr</a>(<a class="code" href="a00023.html">hpd_parameter_t</a> *parameter, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a386bb8668e01dfbc4a11b3c3d65eb92a">hpd_parameter_set_attrs</a>(<a class="code" href="a00023.html">hpd_parameter_t</a> *parameter, ...);</div>
</div><!-- fragment --> <h1><a class="anchor" id="sec_shared_api_cont"></a>
Shared API (Adapters and Applications) - Part II</h1>
<h2><a class="anchor" id="sec_data_model_get"></a>
Data model getters</h2>
<p>To get members from the objects, created by an adapter, applications have the following functions: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#af6aa40d0f9745dcbcb332d8d9dfc778d">hpd_adapter_get_id</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *aid, <span class="keyword">const</span> <span class="keywordtype">char</span> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a3984d04082bb90179cf19115cb3b82d0">hpd_adapter_get_attr</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1935b6fad3c9ee725c52268dca01f8b7">hpd_adapter_get_attrs</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a984525eac9ec4e187917154cac1ea20e">hpd_adapter_first_attr</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aec6ad8ba587691d915dad6fd44a1893d">hpd_adapter_next_attr</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a9005887b17466250fc4fc8d6d253034d">hpd_device_get_id</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *did, <span class="keyword">const</span> <span class="keywordtype">char</span> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a4808217ec639d0b1ef9f890ff727817c">hpd_device_get_attr</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a57b7332a30b03e1679d9cfd70bbcd71f">hpd_device_get_attrs</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a37a3fcb4c0ee0a344469e60d7d4ceadc">hpd_device_first_attr</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aef33fa285b4906fba1427686e7d8b59d">hpd_device_next_attr</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a90138cb6c91b2b93f66c4f8a76495394">hpd_service_get_id</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *sid, <span class="keyword">const</span> <span class="keywordtype">char</span> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aab0ca1039ebd394001e1862ea9d545ba">hpd_service_get_attr</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ab649732a8091d3c716fb1c6e8eaa9a54">hpd_service_get_attrs</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#af976ab216b0e38ff248e50283dcff1e9">hpd_service_has_action</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> method, <a class="code" href="a00021.html#aa552386fb82302e070499d850b2e8ca9">hpd_bool_t</a> *<span class="keywordtype">boolean</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad8b2fbfea2b54c6d744c7f4401f17d7f">hpd_service_first_action</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00005.html#a00088">hpd_action_t</a> **action);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a33a3466581f29468601bc805c630ac9e">hpd_service_next_action</a>(<a class="code" href="a00005.html#a00088">hpd_action_t</a> **action);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a3484f905e2600c79e4fcf79fb316285a">hpd_service_first_attr</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1185afdc4beec2949203e66a370a94bf">hpd_service_next_attr</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a43c7d86904fd4d8c82ec9e52ce52a188">hpd_parameter_get_id</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *pid, <span class="keyword">const</span> <span class="keywordtype">char</span> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2c0ddbf64f9ef35aa4990cdd0f2e38df">hpd_parameter_get_attr</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a76bc01f8aff6499747d86a9c8f1c7858">hpd_parameter_get_attrs</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *<span class="keywordtype">id</span>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2752206cb3fd985542b2677f5b238fc3">hpd_parameter_first_attr</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ac62276ecb4feccf4e9760adc33739620">hpd_parameter_next_attr</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ae383d9141430bb772cbbc9b036271e9b">hpd_action_get_method</a>(<a class="code" href="a00005.html#a00088">hpd_action_t</a> *action, <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> *method);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00042.html#ad8de9589846a9987ae60b199fc05094d">hpd_pair_get</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> *pair, <span class="keyword">const</span> <span class="keywordtype">char</span> **<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
</div><!-- fragment --><p> Again, we have defines to ease foreach loops: </p><div class="fragment"><div class="line"><span class="preprocessor">#define hpd_service_foreach_action(RC, ACTION, ID) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_first_action((ID), &amp;(ACTION)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (ACTION); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_next_action(&amp;(ACTION)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_adapter_foreach_attr(RC, PAIR, ID) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_first_attr((ID), &amp;(PAIR)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PAIR); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_next_attr(&amp;(PAIR)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_device_foreach_attr(RC, PAIR, ID) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_first_attr((ID), &amp;(PAIR)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PAIR); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_next_attr(&amp;(PAIR)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_service_foreach_attr(RC, PAIR, ID) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_first_attr((ID), &amp;(PAIR)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PAIR); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_next_attr(&amp;(PAIR)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_parameter_foreach_attr(RC, PAIR, ID) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_parameter_first_attr((ID), &amp;(PAIR)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PAIR); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_parameter_next_attr(&amp;(PAIR)))</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_data_model_nav"></a>
Data model navigation</h2>
<p>The HomePort data model can be navigated by both adapters and applications, thus only the later will find use for browsing through models created by another module. To do so, the following functions are available: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1fec7f2d4e20a1a76f4abe5e9c54ccbd">hpd_adapter_get_hpd</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *aid, <a class="code" href="a00009.html#a00087">hpd_t</a> **<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a0f2f57b61983ca4ae1075003e1831428">hpd_device_get_hpd</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *did, <a class="code" href="a00009.html#a00087">hpd_t</a> **<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad00868337d8af8bc10e7860bef5f6493">hpd_device_get_adapter</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *did, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **aid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aa1c0b040c81f8cb70343bf914bfba5f3">hpd_service_get_hpd</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *sid, <a class="code" href="a00009.html#a00087">hpd_t</a> **<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1ce881941d5fa5be20c50439118ce79c">hpd_service_get_adapter</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *sid, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **aid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a075014c7d7993dd88aafce4f8365ad4a">hpd_service_get_device</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *sid, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **did);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a53469a17fe23f135e1651fc87b0dc0da">hpd_parameter_get_hpd</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *pid, <a class="code" href="a00009.html#a00087">hpd_t</a> **<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad0aef71da69a9524dd452959fc810c6c">hpd_parameter_get_adapter</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *pid, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **aid);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a8310b5285c9144d05fc11e6b77ab8fb4">hpd_parameter_get_device</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *pid, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **did);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#adc3ca988a540a210fbd2cea132ed0a1e">hpd_parameter_get_service</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> *pid, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **sid);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a35bf26228e2c725f300412ef59eecf4b">hpd_first_adapter</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **adapter_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad992dfa91c033da312b4c34d32607fbd">hpd_first_device</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad8e76c9feefa648fbca586e7d7421501">hpd_first_service</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a7966f9ec00cca8aee9fca41c2f32e56c">hpd_adapter_first_device</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *adapter_id, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a9182a04ddc18d88a20bf55285179a581">hpd_adapter_first_service</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *adapter_id, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a532ad51864602ea42cd8c9ca6aabe189">hpd_device_first_service</a>(<span class="keyword">const</span> <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *device_id, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a6642489e16ed0070356079e6a2bf4591">hpd_service_first_parameter</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *service_id, <a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **parameter_id);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a460c1d013092f65b4bf7d7ece3ff7efc">hpd_next_adapter</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **adapter_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1cbcbcbc95d12b0038514663b26a5f10">hpd_next_device</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ae9856eccf954759353ca4f68a1a2839d">hpd_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a109baeb2fb75c9d1d2ff6506e0176d8e">hpd_adapter_next_device</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#acc19d8881fd760ae0a219a9b70da4eb4">hpd_adapter_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a928f2263cd4b1d300e9c73936531c544">hpd_device_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service_id);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a79ffb29dcdd02248b02806b84bd137ba">hpd_service_next_parameter</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **parameter_id);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ae7e4f0d2f114c40a57c659beef0d2ba2">hpd_find_adapter</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **adapter, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ae975c0096da94afe7f29c421b913fc01">hpd_find_device</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a9533342fe51f5506f9ee48217b0f6818">hpd_find_service</a>(<a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ad29ebd4919d9686cbc01f86a2df053e5">hpd_adapter_find_device</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *adapter, <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a741249078f8954f6f696a51842c4f43d">hpd_adapter_find_service</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> *adapter, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ac1a66ea8d3127739f46da1a91fe7c536">hpd_device_find_service</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *device, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ac2a5feec65644b9bb30dee28c8e92896">hpd_service_find_parameter</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *service, <a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **parameter, ...);</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a89e6a8d8bd090ae721df20f6ecd516d4">hpd_find_next_adapter</a>(<a class="code" href="a00011.html#a00089">hpd_adapter_id_t</a> **adapter, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a40e65b8635bbf91c398dd8f930de7cf9">hpd_find_next_device</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#aaa5ce78b09115c0b451b56a4a3f75b50">hpd_find_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#adea47cfb7f7297ab81b7c9f70beeafc1">hpd_adapter_find_next_device</a>(<a class="code" href="a00011.html#a00091">hpd_device_id_t</a> **device, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#af6bd6ab8c045f7ea05be9b247f7590a3">hpd_adapter_find_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a1f49eede300a01c35cab483c46ac1358">hpd_device_find_next_service</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#ac4dd2441bce92c17ee167afdc535fed6">hpd_service_find_next_parameter</a>(<a class="code" href="a00011.html#a00102">hpd_parameter_id_t</a> **parameter, ...);</div>
</div><!-- fragment --><p> In brief: Get functions will navigate upwards in the hierarchy, first functions will get the first object in the list under the given object, next will give the next one, and the find functions are used to find objects based on attributes. The arguments given to a find function is key-value pairs, and the attributes of an object must match all the given attributes (e.g. strcmp == 0) for an object to be found, attributes whose key is not given as attribute are not considered. A find function will give the first object to match, where a find next function will give the next matching object.</p>
<p>Because first-next function are a bit complicated to use, the following defines are also available to create simple foreach loops (based on the same principle from libev): </p><div class="fragment"><div class="line"><span class="preprocessor">#define hpd_foreach_adapter(RC, ADAPTER, HPD) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_first_adapter((HPD), &amp;(ADAPTER)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (ADAPTER); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_next_adapter(&amp;(ADAPTER)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_foreach_device(RC, DEVICE, HPD) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_first_device((HPD), &amp;(DEVICE)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (DEVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_next_device(&amp;(DEVICE)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_foreach_service(RC, SERVICE, HPD) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_first_service((HPD), &amp;(SERVICE)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_next_service(&amp;(SERVICE)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_adapter_foreach_device(RC, DEVICE, ADAPTER) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_first_device((ADAPTER), &amp;(DEVICE)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (DEVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_next_device(&amp;(DEVICE)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_adapter_foreach_service(RC, SERVICE, ADAPTER) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_first_service((ADAPTER), &amp;(SERVICE)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_next_service(&amp;(SERVICE)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_device_foreach_service(RC, SERVICE, DEVICE) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_first_service((DEVICE), &amp;(SERVICE)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_next_service(&amp;(SERVICE)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_service_foreach_parameter(RC, PARAMETER, SERVICE) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_first_parameter((SERVICE), &amp;(PARAMETER)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PARAMETER); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_next_parameter(&amp;(PARAMETER)))</span></div>
<div class="line"><span class="preprocessor">#define hpd_find_foreach_adapter(RC, ADAPTER, HPD, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_adapter((HPD), (ADAPTER), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (ADAPTER); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_next_adapter((ADAPTER), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_find_foreach_device(RC, DEVICE, HPD, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_device((HPD), (DEVICE), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (DEVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_next_device((DEVICE), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_find_foreach_service(RC, SERVICE, HPD, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_service((HPD), (SERVICE), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_find_next_service((SERVICE), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_adapter_find_foreach_device(RC, DEVICE, ADAPTER, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_find_device((ADAPTER), &amp;(DEVICE), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (DEVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_find_next_device(&amp;(DEVICE), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_adapter_find_foreach_service(RC, SERVICE, ADAPTER, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_find_service((ADAPTER), (SERVICE), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_adapter_find_next_service((SERVICE), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_device_find_foreach_service(RC, SERVICE, DEVICE, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_find_service((DEVICE), (SERVICE), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (SERVICE); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_device_find_next_service((SERVICE), ##__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor">#define hpd_service_find_foreach_parameter(RC, PARAMETER, SERVICE, ...) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_find_parameter((SERVICE), (PARAMETER), ##__VA_ARGS__); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PARAMETER); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_service_find_next_parameter((PARAMETER), ##__VA_ARGS__))</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="sec_comm"></a>
Communication</h1>
<h2><a class="anchor" id="sec_value"></a>
Shared API - Value structure</h2>
<p>The value structure is used in both get and put requests and thus is available for both adapters and applications: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a344d7fd8e951958c7ce52209d60f2ccf">hpd_value_alloc</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> **<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *body, <span class="keywordtype">int</span> len);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a8b5be61f356ac1d72634654e16794610">hpd_value_copy</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> **dst, <span class="keyword">const</span> <a class="code" href="a00024.html#a00110">hpd_value_t</a> *src);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a214a6d699e1e5cbff10fa2d6fee721ff">hpd_value_free</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a75b6ef13b716e7b51a4a24b0df588e33">hpd_value_set_header</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2611edcf1f90741780c5160a1e2d622e">hpd_value_set_headers</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2a9be82383d9235cd652c50144943beb">hpd_value_get_body</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **body, <span class="keywordtype">size_t</span> *len);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a66f56ffbc6b399411195fdb4f0328596">hpd_value_get_header</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00006.html#ad0ed575d03a4dca41d2d38d4fa19a442">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **val);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a70c246dd2f5f922e0a9cf636b04823cc">hpd_value_get_headers</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, ...);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a2c93801b7485fbf5b35652b6aa8b4aeb">hpd_value_first_header</a>(<a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>, <a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00056.html#a576a588cbe54bea7b62a992ed557c6b7">hpd_value_next_header</a>(<a class="code" href="a00022.html#a00101">hpd_pair_t</a> **pair);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#define hpd_value_foreach_header(RC, PAIR, VALUE) for ( \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_value_first_header((VALUE), (PAIR)); \</span></div>
<div class="line"><span class="preprocessor">    !(RC) &amp;&amp; (PAIR); \</span></div>
<div class="line"><span class="preprocessor">    (RC) = hpd_value_next_header((PAIR)))</span></div>
</div><!-- fragment --><p> The body of a value is the actual value, where the headers are additional attributes, which are currently unused but will be used to indicate time-to-live for caching, but are defined generic so they can easily be expanded without breaking the API. Note it is also possible for adapters and applications to store their own custom headers, similar to the principle in HTTP headers.</p>
<p>The len in hpd_value_alloc can be set to HPD_NULL_TERMINATED if body is a \0 terminated string:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define HPD_NULL_TERMINATED -1</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="sec_adapter_comm"></a>
Adapter API - Communication</h2>
<p>Action functions will need functions related to requests/responses to manage these (functions to manage values are shared with applications and will be shown later): </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#aca2889acbf34cd741e8b152ffc8a21db">hpd_request_get_service</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00103">hpd_request_t</a> *req, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **<span class="keywordtype">id</span>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a1b0d788115cc35bceceb946f20298955">hpd_request_get_method</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00103">hpd_request_t</a> *req, <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> *method);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#aef0a17399a2346728d501e98602c0516">hpd_request_get_value</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00103">hpd_request_t</a> *req, <a class="code" href="a00024.html#a00110">hpd_value_t</a> **<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#aff4eae061b1220e0bb55de72f8129493">hpd_response_alloc</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> **response, <a class="code" href="a00024.html#a00103">hpd_request_t</a> *request, <a class="code" href="a00021.html#af6829d4094acafb9d01a245f98ebd995">hpd_status_t</a> status);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a2f50d49e360ca2689857e43bfcd533b3">hpd_response_free</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> *response);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a23aa9a2e797738188778c906be59221a">hpd_response_set_value</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a0f52d1f4e06fe16eb27a1b394bcd6d86">hpd_respond</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> *response);</div>
</div><!-- fragment --><p> And when, we are considering communication, an adapter should call the following function, whenever a service has changed value: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00052.html#a4e10a7a459f294991735e9bcd384b03a">hpd_changed</a>(<a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00024.html#a00110">hpd_value_t</a> *val);</div>
</div><!-- fragment --> <div align="center">
<object type="image/svg+xml" data="inline_umlgraph_8.svg"></object>
<div class="caption">
Lifetime of request/response structures</div>
</div>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_9.svg"></object>
<div class="caption">
Lifetime of request/response structures</div>
</div>
<h2><a class="anchor" id="sec_application_api"></a>
Application API - Communication</h2>
<p>The functions in the Application API are only available for applications.</p>
<p>For hpd_request_t, hpd_response_t and hpd_listener_t functions we need the following callbacks: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a0d8f64601cfb69c9ba46470a414f13e6">hpd_response_f</a>) (<a class="code" href="a00024.html#a00104">hpd_response_t</a> *res);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a4f0f482759e348a059a70b038805b31c">hpd_value_f</a>) (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <span class="keyword">const</span> <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *service, <span class="keyword">const</span> <a class="code" href="a00024.html#a00110">hpd_value_t</a> *val);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> (*<a class="code" href="a00021.html#a30f772da6ef5214e6b11e99daf1b6e12">hpd_device_f</a>) (<span class="keywordtype">void</span> *<a class="code" href="a00038.html#a7eeea53acac92b2cc17084963282fc11">data</a>, <span class="keyword">const</span> <a class="code" href="a00011.html#a00091">hpd_device_id_t</a> *device);</div>
</div><!-- fragment --><p> The functions for requests and response are the reverse of an adapter (an application can create requests and read the values of a response): </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#ac8e7c21db1c80443994e79d29eae8286">hpd_request_alloc</a>(<a class="code" href="a00024.html#a00103">hpd_request_t</a> **request, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> *<span class="keywordtype">id</span>, <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> method, <a class="code" href="a00021.html#a0d8f64601cfb69c9ba46470a414f13e6">hpd_response_f</a> <a class="code" href="a00025.html#abccd0d79ed3acf405337a07b4572d223">on_response</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a70445c0ba17e60a009c9557ec0dd7d3b">hpd_request_free</a>(<a class="code" href="a00024.html#a00103">hpd_request_t</a> *request);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#af0e001de59db25ddc4a3df544e14c490">hpd_request_set_value</a>(<a class="code" href="a00024.html#a00103">hpd_request_t</a> *request, <a class="code" href="a00024.html#a00110">hpd_value_t</a> *<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#ac9eeff8f3e494a62942c2ebed8f05cd9">hpd_request_set_data</a>(<a class="code" href="a00024.html#a00103">hpd_request_t</a> *request, <span class="keywordtype">void</span> *data, <a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a> <a class="code" href="a00025.html#a65f3fe01ba50f1473cad1a4418cfdf09">on_free</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a077adc41aa1c0f7270a995ff42420424">hpd_request</a>(<a class="code" href="a00024.html#a00103">hpd_request_t</a> *request);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a132befb32dc0261ff781b3f476decbe1">hpd_response_get_status</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00021.html#af6829d4094acafb9d01a245f98ebd995">hpd_status_t</a> *status);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#acb8d8626c4aa1d350e4d2e15a8724ffa">hpd_response_get_value</a>(<a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00024.html#a00110">hpd_value_t</a> **<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#acc5f0ce6e069361330a20015760e5968">hpd_response_get_request_data</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <span class="keywordtype">void</span> **data);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a5e684a766c2a3c5b78c9680edfcecb36">hpd_response_get_request_service</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00011.html#a00107">hpd_service_id_t</a> **service);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#ad1011e309216eeb47ef204a18535d6cf">hpd_response_get_request_method</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00021.html#a6ff2623d753ebcd86cab4fe48e1956b7">hpd_method_t</a> *method);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a87c46a9e7497bce40af47bda15918bf6">hpd_response_get_request_value</a>(<span class="keyword">const</span> <a class="code" href="a00024.html#a00104">hpd_response_t</a> *response, <a class="code" href="a00024.html#a00110">hpd_value_t</a> **<a class="code" href="a00038.html#aee53bdc848584e095375d0d39aa400b8">value</a>);</div>
</div><!-- fragment --><p> In addition, an application can also create listeners. Listeners can be created on any object (HomePort, adapter, device, and service) and will be called for that object and everything below if the conditions are met. E.g., a listener with a value callback on an adapter will be called if any service under that adapter changes value. Function to manage listeners: </p><div class="fragment"><div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a49f0552ce2f504f4769612ac6cac6933">hpd_listener_alloc</a>(<a class="code" href="a00019.html">hpd_listener_t</a> **listener, <a class="code" href="a00009.html#a00087">hpd_t</a> *<a class="code" href="a00009.html#a00087">hpd</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a6ed81ad49352be61e2a8710624396e93">hpd_listener_set_data</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener, <span class="keywordtype">void</span> *data, <a class="code" href="a00021.html#aed058b74824064628a0bf3d07ef9ab02">hpd_free_f</a> <a class="code" href="a00025.html#a65f3fe01ba50f1473cad1a4418cfdf09">on_free</a>);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#aaf1e38cf565af096ee9baf39f4e6bba8">hpd_listener_set_value_callback</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener, <a class="code" href="a00021.html#a4f0f482759e348a059a70b038805b31c">hpd_value_f</a> on_change);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a5b21c4186d69cad1bc1eee041ce4c220">hpd_listener_set_device_callback</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener, <a class="code" href="a00021.html#a30f772da6ef5214e6b11e99daf1b6e12">hpd_device_f</a> on_attach, <a class="code" href="a00021.html#a30f772da6ef5214e6b11e99daf1b6e12">hpd_device_f</a> on_detach);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#ac154bd8740424c2a5488b54cbd75f524">hpd_subscribe</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a96236544de2ed9cacdc03b5dedeb6d4e">hpd_listener_free</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a726457bb2a2aa5a9fa34a49913e43ae1">hpd_listener_get_data</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener, <span class="keywordtype">void</span> **data);</div>
<div class="line"><a class="code" href="a00021.html#ad26385b6709a2fc6c0f9141e11598d7a">hpd_error_t</a> <a class="code" href="a00054.html#a2378ed927b904fdc33551792fe841d90">hpd_foreach_attached</a>(<a class="code" href="a00019.html">hpd_listener_t</a> *listener);</div>
</div><!-- fragment --><p> The foreach function will cause the given listener to be called for each device that is already attached.</p>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_10.svg"></object>
<div class="caption">
Lifetime of request/response structures</div>
</div>
<dl class="todo"><dt><b><a class="el" href="a00081.html#_todo000004">Todo:</a></b></dt><dd>Finish listener sequence chart</dd></dl>
<div align="center">
<object type="image/svg+xml" data="inline_umlgraph_11.svg"></object>
<div class="caption">
Lifetime of listener structures</div>
</div>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 26 2016 15:14:28 for Homeport Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
